import{c as Ee,r as g,h as Gn,j as e,S as Kn,L as Yn,a as Xn,T as Zn,b as Jn,B as Te,P as Qn,d as es,e as ts,f as Gt,g as Kt,i as Yt,D as ns,k as ss,l as os,m as ht,R as we,n as rs,o as as,u as is,p as De,q as Pe,s as ls,t as Ve,v as cs,w as Re,x as Nt,y as ds,z as us,A as ln,C as ms}from"./index-C-AYS2yM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Ee("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=Ee("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=Ee("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=Ee("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=Ee("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=Ee("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=Ee("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Ee("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=Ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),vs=["#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#ec4899","#ffffff","#000000"],Ts=[2,4,6,8],Es=[14,18,24,32],Ss=({targetElement:t,onSend:n,onCancel:a})=>{const r=g.useRef(null),s=g.useRef(null),f=g.useRef(new Map),d=g.useRef(null),[i,x]=g.useState({top:0,left:0,width:0,height:0}),[m,u]=g.useState("draw"),[v,S]=g.useState("#ef4444"),[c,h]=g.useState(4),[l,T]=g.useState(18),[E,j]=g.useState([]),[A,b]=g.useState(!1),[I,M]=g.useState([]),[_,w]=g.useState(null),[C,D]=g.useState(null),[N,z]=g.useState(""),[L,$]=g.useState(!1);g.useEffect(()=>{let p;const P=()=>{const O=t.getBoundingClientRect();x(U=>U.top!==O.top||U.left!==O.left||U.width!==O.width||U.height!==O.height?{top:O.top,left:O.left,width:O.width,height:O.height}:U),p=requestAnimationFrame(P)};return p=requestAnimationFrame(P),()=>{cancelAnimationFrame(p)}},[t]),g.useEffect(()=>{var P,O;const p=s.current;if(p)if(_&&!C){const U=f.current.get(_);U&&(p.nodes([U]),(P=p.getLayer())==null||P.batchDraw())}else p.nodes([]),(O=p.getLayer())==null||O.batchDraw()},[_,C]),g.useEffect(()=>{const p=O=>{const U=O.target,B=O.clientX,Y=O.clientY,X=B>=i.left&&B<=i.left+i.width&&Y>=i.top-60&&Y<=i.top+i.height,Se=U.closest("[data-annotation-toolbar]")!==null,ce=U.closest("[data-radix-popper-content-wrapper]")!==null;!X&&!Se&&!ce&&a()},P=setTimeout(()=>{document.addEventListener("mousedown",p)},100);return()=>{clearTimeout(P),document.removeEventListener("mousedown",p)}},[i,a]),g.useEffect(()=>{const p=P=>{if(C){P.key==="Escape"&&J();return}(P.key==="Delete"||P.key==="Backspace")&&_&&(P.preventDefault(),M(O=>O.filter(U=>U.id!==_)),w(null))};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[_,C]);const J=g.useCallback(()=>{C&&M(p=>p.map(P=>P.id===C?{...P,text:N}:P)),D(null),z("")},[C,N]),G=p=>{var O,U;const P=p.target===p.target.getStage();if(m==="draw"){w(null),b(!0);const B=(O=p.target.getStage())==null?void 0:O.getPointerPosition();if(B){const Y={id:`line-${Date.now()}`,points:[B.x,B.y],color:v,strokeWidth:c};j(X=>[...X,Y])}}else if(m==="text"&&P){C&&J(),w(null);const B=(U=p.target.getStage())==null?void 0:U.getPointerPosition();if(B){const Y={id:`text-${Date.now()}`,x:B.x,y:B.y,text:"",color:v,fontSize:l};M(X=>[...X,Y]),D(Y.id),z(""),setTimeout(()=>{var X;return(X=d.current)==null?void 0:X.focus()},50)}}},se=p=>{var O;if(!A||m!=="draw")return;const P=(O=p.target.getStage())==null?void 0:O.getPointerPosition();P&&j(U=>{const B=[...U],Y=B[B.length-1];return Y&&(Y.points=[...Y.points,P.x,P.y]),B})},ee=()=>{b(!1)},ie=p=>{C&&C!==p.id&&J(),w(p.id)},Oe=p=>{D(p.id),z(p.text),setTimeout(()=>{var P;return(P=d.current)==null?void 0:P.focus()},50)},V=(p,P)=>{M(O=>O.map(U=>U.id===P?{...U,x:p.target.x(),y:p.target.y()}:U))},qe=(p,P)=>{const O=p.target,U=O.scaleX(),B=O.scaleY(),Y=I.find(X=>X.id===P);if(Y){const X=Math.max(10,Math.round(Y.fontSize*Math.max(U,B)));M(Se=>Se.map(ce=>ce.id===P?{...ce,x:O.x(),y:O.y(),fontSize:X}:ce)),O.scaleX(1),O.scaleY(1)}},K=g.useCallback(()=>{E.length>0?j(p=>p.slice(0,-1)):I.length>0&&M(p=>p.slice(0,-1))},[E.length,I.length]),Ge=g.useCallback(()=>{j([]),M([]),w(null),D(null)},[]),H=g.useCallback(async()=>{if(r.current){$(!0);try{w(null),D(null),await new Promise(Y=>setTimeout(Y,100));const p=await Gn(t,{useCORS:!0,logging:!1,backgroundColor:null}),P=r.current.toCanvas({pixelRatio:p.width/i.width}),O=document.createElement("canvas");O.width=p.width,O.height=p.height;const U=O.getContext("2d");U&&(U.drawImage(p,0,0),U.drawImage(P,0,0));const B=O.toDataURL("image/png");n(B)}catch(p){console.error("Error capturing annotation:",p),$(!1)}}},[t,i.width,n]),me=I.find(p=>p.id===C);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"fixed z-[9999]",style:{top:i.top,left:i.left,width:i.width,height:i.height},children:[e.jsx("div",{className:"absolute inset-0 ring-4 rounded-lg pointer-events-none",style:{"--tw-ring-color":"#D4EDE5"}}),e.jsx(Kn,{ref:r,width:i.width,height:i.height,onMouseDown:G,onMouseMove:se,onMouseUp:ee,onTouchStart:G,onTouchMove:se,onTouchEnd:ee,style:{cursor:m==="draw"?"crosshair":"default"},children:e.jsxs(Yn,{children:[E.map(p=>e.jsx(Xn,{points:p.points,stroke:p.color,strokeWidth:p.strokeWidth,lineCap:"round",lineJoin:"round",tension:.5,globalCompositeOperation:"source-over"},p.id)),I.map(p=>e.jsx(Zn,{ref:P=>{P?f.current.set(p.id,P):f.current.delete(p.id)},id:p.id,x:p.x,y:p.y,text:p.id===C?"":p.text||"Click to type...",fontSize:p.fontSize,fill:p.id===C?"transparent":p.color,draggable:m==="text",onClick:()=>ie(p),onTap:()=>ie(p),onDblClick:()=>Oe(p),onDblTap:()=>Oe(p),onDragEnd:P=>V(P,p.id),onTransformEnd:P=>qe(P,p.id),opacity:p.text||p.id===C?1:.5},p.id)),e.jsx(Jn,{ref:s,rotateEnabled:!1,borderEnabled:!1,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],anchorSize:10,anchorCornerRadius:2,anchorFill:"#0D7377",anchorStroke:"#0D7377",keepRatio:!0})]})}),C&&me&&e.jsx("textarea",{ref:d,value:N,onChange:p=>z(p.target.value),onBlur:J,placeholder:"Type text...",className:"absolute bg-transparent border-2 border-[#0D7377] rounded p-1 resize-none focus:outline-none",style:{left:me.x,top:me.y,color:me.color,fontSize:me.fontSize,minWidth:100,minHeight:me.fontSize+10},autoFocus:!0}),e.jsx("div",{className:"absolute -top-14 left-0 right-0 flex items-center justify-center gap-2","data-annotation-toolbar":!0,children:e.jsxs("div",{className:"flex items-center gap-2 bg-background/95 backdrop-blur-sm rounded-lg shadow-lg border p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-muted rounded-md p-0.5",children:[e.jsx(Te,{variant:m==="draw"?"default":"ghost",size:"icon",className:`h-7 w-7 ${m==="draw"?"bg-[#D4EDE5] text-[#0D7377] hover:bg-[#C0E5DA]":"hover:bg-[#D4EDE5] hover:text-[#0D7377]"}`,onClick:()=>{u("draw"),w(null)},title:"Draw mode",children:e.jsx(cn,{className:"h-4 w-4"})}),e.jsx(Te,{variant:m==="text"?"default":"ghost",size:"icon",className:`h-7 w-7 ${m==="text"?"bg-[#D4EDE5] text-[#0D7377] hover:bg-[#C0E5DA]":"hover:bg-[#D4EDE5] hover:text-[#0D7377]"}`,onClick:()=>u("text"),title:"Text mode",children:e.jsx(xs,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"w-px h-6 bg-border"}),e.jsxs(Qn,{children:[e.jsx(es,{asChild:!0,children:e.jsxs(Te,{variant:"outline",size:"icon",className:"h-8 w-8 relative hover:bg-[#D4EDE5] hover:text-[#0D7377] hover:border-[#D4EDE5]",title:"Color",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("div",{className:"absolute bottom-0.5 right-0.5 w-2.5 h-2.5 rounded-full border border-background",style:{backgroundColor:v}})]})}),e.jsxs(ts,{className:"w-auto p-2","data-annotation-toolbar":!0,children:[e.jsx("div",{className:"grid grid-cols-5 gap-1",children:vs.map(p=>e.jsx("button",{className:`w-6 h-6 rounded-md border-2 ${v===p?"border-primary":"border-transparent"}`,style:{backgroundColor:p},onClick:()=>S(p)},p))}),m==="draw"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-2 pt-2 border-t",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Brush Size"}),e.jsx("div",{className:"flex gap-1",children:Ts.map(p=>e.jsx("button",{className:`flex items-center justify-center w-8 h-8 rounded-md ${c===p?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,onClick:()=>h(p),children:e.jsx("div",{className:"rounded-full bg-current",style:{width:p*2,height:p*2}})},p))})]})}),m==="text"&&e.jsxs("div",{className:"mt-2 pt-2 border-t",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Font Size"}),e.jsx("div",{className:"flex gap-1",children:Es.map(p=>e.jsx("button",{className:`flex items-center justify-center w-8 h-8 rounded-md text-xs ${l===p?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,onClick:()=>T(p),children:p},p))})]})]})]}),e.jsx("div",{className:"w-px h-6 bg-border"}),e.jsx(Te,{variant:"outline",size:"icon",className:"h-8 w-8 hover:bg-[#D4EDE5] hover:text-[#0D7377] hover:border-[#D4EDE5]",onClick:K,disabled:E.length===0&&I.length===0,children:e.jsx(bs,{className:"h-4 w-4"})}),e.jsx(Te,{variant:"outline",size:"icon",className:"h-8 w-8 hover:bg-[#D4EDE5] hover:text-[#0D7377] hover:border-[#D4EDE5]",onClick:Ge,disabled:E.length===0&&I.length===0,children:e.jsx(ps,{className:"h-4 w-4"})}),e.jsx("div",{className:"w-px h-6 bg-border"}),e.jsxs(Te,{variant:"outline",size:"sm",onClick:a,className:"h-8 hover:bg-[#D4EDE5] hover:text-[#0D7377] hover:border-[#D4EDE5]",children:[e.jsx(ys,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsxs(Te,{variant:"outline",size:"sm",onClick:H,disabled:L,className:"h-8 hover:bg-[#D4EDE5] hover:text-[#0D7377] hover:border-[#D4EDE5]",children:[e.jsx(dn,{className:"h-4 w-4 mr-1"}),L?"Sending...":"Send to Chat"]})]})}),E.length===0&&I.length===0&&!C&&e.jsx("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center pointer-events-none",children:e.jsx("div",{className:"bg-background/90 backdrop-blur-sm rounded-md px-3 py-1.5 text-sm text-muted-foreground shadow-sm",children:m==="draw"?"Draw on the section to annotate, then send to chat":"Click to add text. Drag to move. Double-click to edit."})})]})})},de=({id:t,children:n,className:a="",padding:r="md",isPreview:s=!1,onEditSection:f})=>{const[d,i]=g.useState(!1),x=g.useRef(null),m={none:"",sm:"py-2",md:"py-3",lg:"py-6"};g.useEffect(()=>{const h=l=>{l.detail.sectionId!==t&&d&&i(!1)};return window.addEventListener("annotation-overlay-opened",h),()=>{window.removeEventListener("annotation-overlay-opened",h)}},[t,d]);const u=()=>{window.dispatchEvent(new CustomEvent("annotation-overlay-opened",{detail:{sectionId:t}})),i(!0)},v=()=>{i(!1)},S=h=>{i(!1),t&&(window.parent.postMessage({type:"add-annotation-to-chat",sectionId:t,imageDataUrl:h},"*"),f&&f(`Annotated Section ${t}: [Image attached]`))},c=h=>{if(!s&&t){if(h.target.closest("button"))return;window.parent.postMessage({type:"section-selected",sectionId:t},"*")}};return e.jsxs(e.Fragment,{children:[d&&x.current&&e.jsx(Ss,{targetElement:x.current,onSend:S,onCancel:v,sectionId:t}),e.jsxs("section",{ref:x,id:t,className:`w-full group flex gap-3 pr-3 ${m[r]} ${a} ${s?"":"hover:ring-1 rounded-lg transition-all"}`,style:s?void 0:{"--tw-ring-color":"#D4EDE5"},"data-section-id":t,onClick:c,children:[!s&&e.jsxs("div",{className:"relative z-10 flex items-center gap-px opacity-0 group-hover:opacity-100 transition-opacity pt-1",children:[e.jsxs(Gt,{children:[e.jsx(Kt,{asChild:!0,children:e.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7 hover:bg-[#D4EDE5] hover:text-[#0D7377]",onClick:()=>{console.log("Add section clicked (not implemented in code mode)")},children:e.jsx(gs,{className:"h-4 w-4"})})}),e.jsx(Yt,{side:"bottom",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Click"})," to add below"]})})]}),e.jsxs(ns,{children:[e.jsxs(Gt,{children:[e.jsx(Kt,{asChild:!0,children:e.jsx(ss,{asChild:!0,children:e.jsx(Te,{variant:"ghost",size:"icon",className:"h-7 w-7 cursor-grab active:cursor-grabbing hover:bg-[#D4EDE5] hover:text-[#0D7377]",children:e.jsx(hs,{className:"h-4 w-4"})})})}),e.jsx(Yt,{side:"bottom",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Drag"})," to move",e.jsx("br",{}),e.jsx("span",{className:"font-semibold",children:"Click"})," to open menu"]})})]}),e.jsxs(os,{align:"start",children:[e.jsxs(ht,{className:"text",onClick:()=>{t&&(window.parent.postMessage({type:"add-to-chat",sectionId:t},"*"),f&&f(`Context: Section ${t}`))},children:[e.jsx(dn,{className:"mr-2 h-4 w-4"}),"Add to chat"]}),e.jsxs(ht,{onClick:u,children:[e.jsx(cn,{className:"mr-2 h-4 w-4"}),"Annotate"]}),e.jsx(ht,{className:"text-destructive",onClick:()=>{console.log("Delete section clicked (not implemented in code mode)")},children:"Delete"})]})]})]}),e.jsx("div",{className:"flex-1 min-w-0",children:n})]})]})},Ie=({children:t,className:n="",maxWidth:a="full"})=>{const r={none:"",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-5xl","2xl":"max-w-7xl",full:"max-w-full"};return e.jsx("div",{className:`w-full ${r[a]} ${n}`,"data-layout-type":"full-width",children:t})},un=({children:t,className:n="",ratio:a="1:1",gap:r="md",reverse:s=!1,align:f="start"})=>{const d=g.Children.toArray(t);d.length!==2&&console.warn(`SplitLayout expects exactly 2 children, but received ${d.length}`);const i={"1:1":"grid-cols-1 md:grid-cols-2","1:2":"grid-cols-1 md:grid-cols-3","2:1":"grid-cols-1 md:grid-cols-3","1:3":"grid-cols-1 md:grid-cols-4","3:1":"grid-cols-1 md:grid-cols-4","2:3":"grid-cols-1 md:grid-cols-5","3:2":"grid-cols-1 md:grid-cols-5"},x={"1:1":["",""],"1:2":["md:col-span-1","md:col-span-2"],"2:1":["md:col-span-2","md:col-span-1"],"1:3":["md:col-span-1","md:col-span-3"],"3:1":["md:col-span-3","md:col-span-1"],"2:3":["md:col-span-2","md:col-span-3"],"3:2":["md:col-span-3","md:col-span-2"]},m={none:"gap-0",sm:"gap-3",md:"gap-6",lg:"gap-8",xl:"gap-12"},u={start:"items-start",center:"items-center",end:"items-end",stretch:"items-stretch"},[v,S]=s?[d[1],d[0]]:d,[c,h]=s?[x[a][1],x[a][0]]:x[a];return e.jsxs("div",{className:`grid ${i[a]} ${m[r]} ${u[f]} ${n}`,"data-layout-type":"split","data-layout-ratio":a,children:[e.jsx("div",{className:c,children:v}),e.jsx("div",{className:h,children:S})]})},mn=({children:t,className:n="",columns:a=3,tabletColumns:r,mobileColumns:s=1,gap:f="md",align:d="start"})=>{const i={1:"md:grid-cols-1 lg:grid-cols-1",2:"md:grid-cols-2 lg:grid-cols-2",3:"md:grid-cols-2 lg:grid-cols-3",4:"md:grid-cols-3 lg:grid-cols-4",5:"md:grid-cols-3 lg:grid-cols-5",6:"md:grid-cols-4 lg:grid-cols-6"},x={1:"md:grid-cols-1",2:"md:grid-cols-2",3:"md:grid-cols-3",4:"md:grid-cols-4"},m={1:"grid-cols-1",2:"grid-cols-2"},u={none:"gap-0",sm:"gap-3",md:"gap-6",lg:"gap-8",xl:"gap-12"},v={start:"items-start",center:"items-center",end:"items-end",stretch:"items-stretch"},S=r?`${m[s]} ${x[r]} lg:grid-cols-${a}`:`${m[s]} ${i[a]}`;return e.jsx("div",{className:`grid ${S} ${u[f]} ${v[d]} ${n}`,"data-layout-type":"grid","data-layout-columns":a,children:t})};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:hn,setPrototypeOf:Xt,isFrozen:ws,getPrototypeOf:js,getOwnPropertyDescriptor:Ns}=Object;let{freeze:re,seal:he,create:vt}=Object,{apply:Tt,construct:Et}=typeof Reflect<"u"&&Reflect;re||(re=function(n){return n});he||(he=function(n){return n});Tt||(Tt=function(n,a){for(var r=arguments.length,s=new Array(r>2?r-2:0),f=2;f<r;f++)s[f-2]=arguments[f];return n.apply(a,s)});Et||(Et=function(n){for(var a=arguments.length,r=new Array(a>1?a-1:0),s=1;s<a;s++)r[s-1]=arguments[s];return new n(...r)});const et=ae(Array.prototype.forEach),As=ae(Array.prototype.lastIndexOf),Zt=ae(Array.prototype.pop),Ue=ae(Array.prototype.push),Ms=ae(Array.prototype.splice),nt=ae(String.prototype.toLowerCase),ft=ae(String.prototype.toString),gt=ae(String.prototype.match),We=ae(String.prototype.replace),_s=ae(String.prototype.indexOf),Cs=ae(String.prototype.trim),fe=ae(Object.prototype.hasOwnProperty),oe=ae(RegExp.prototype.test),He=ks(TypeError);function ae(t){return function(n){n instanceof RegExp&&(n.lastIndex=0);for(var a=arguments.length,r=new Array(a>1?a-1:0),s=1;s<a;s++)r[s-1]=arguments[s];return Tt(t,n,r)}}function ks(t){return function(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return Et(t,a)}}function F(t,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:nt;Xt&&Xt(t,null);let r=n.length;for(;r--;){let s=n[r];if(typeof s=="string"){const f=a(s);f!==s&&(ws(n)||(n[r]=f),s=f)}t[s]=!0}return t}function Ds(t){for(let n=0;n<t.length;n++)fe(t,n)||(t[n]=null);return t}function ve(t){const n=vt(null);for(const[a,r]of hn(t))fe(t,a)&&(Array.isArray(r)?n[a]=Ds(r):r&&typeof r=="object"&&r.constructor===Object?n[a]=ve(r):n[a]=r);return n}function $e(t,n){for(;t!==null;){const r=Ns(t,n);if(r){if(r.get)return ae(r.get);if(typeof r.value=="function")return ae(r.value)}t=js(t)}function a(){return null}return a}const Jt=re(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),pt=re(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),xt=re(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Rs=re(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),bt=re(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Is=re(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Qt=re(["#text"]),en=re(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),yt=re(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),tn=re(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),tt=re(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ps=he(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ls=he(/<%[\w\W]*|[\w\W]*%>/gm),Os=he(/\$\{[\w\W]*/gm),Fs=he(/^data-[\-\w.\u00B7-\uFFFF]+$/),zs=he(/^aria-[\-\w]+$/),fn=he(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Us=he(/^(?:\w+script|data):/i),Ws=he(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),gn=he(/^html$/i),Hs=he(/^[a-z][.\w]*(-[.\w]+)+$/i);var nn=Object.freeze({__proto__:null,ARIA_ATTR:zs,ATTR_WHITESPACE:Ws,CUSTOM_ELEMENT:Hs,DATA_ATTR:Fs,DOCTYPE_NAME:gn,ERB_EXPR:Ls,IS_ALLOWED_URI:fn,IS_SCRIPT_OR_DATA:Us,MUSTACHE_EXPR:Ps,TMPLIT_EXPR:Os});const Be={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},$s=function(){return typeof window>"u"?null:window},Bs=function(n,a){if(typeof n!="object"||typeof n.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";a&&a.hasAttribute(s)&&(r=a.getAttribute(s));const f="dompurify"+(r?"#"+r:"");try{return n.createPolicy(f,{createHTML(d){return d},createScriptURL(d){return d}})}catch{return console.warn("TrustedTypes policy "+f+" could not be created."),null}},sn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function pn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$s();const n=R=>pn(R);if(n.version="3.3.0",n.removed=[],!t||!t.document||t.document.nodeType!==Be.document||!t.Element)return n.isSupported=!1,n;let{document:a}=t;const r=a,s=r.currentScript,{DocumentFragment:f,HTMLTemplateElement:d,Node:i,Element:x,NodeFilter:m,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:v,DOMParser:S,trustedTypes:c}=t,h=x.prototype,l=$e(h,"cloneNode"),T=$e(h,"remove"),E=$e(h,"nextSibling"),j=$e(h,"childNodes"),A=$e(h,"parentNode");if(typeof d=="function"){const R=a.createElement("template");R.content&&R.content.ownerDocument&&(a=R.content.ownerDocument)}let b,I="";const{implementation:M,createNodeIterator:_,createDocumentFragment:w,getElementsByTagName:C}=a,{importNode:D}=r;let N=sn();n.isSupported=typeof hn=="function"&&typeof A=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:z,ERB_EXPR:L,TMPLIT_EXPR:$,DATA_ATTR:J,ARIA_ATTR:G,IS_SCRIPT_OR_DATA:se,ATTR_WHITESPACE:ee,CUSTOM_ELEMENT:ie}=nn;let{IS_ALLOWED_URI:Oe}=nn,V=null;const qe=F({},[...Jt,...pt,...xt,...bt,...Qt]);let K=null;const Ge=F({},[...en,...yt,...tn,...tt]);let H=Object.seal(vt(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),me=null,p=null;const P=Object.seal(vt(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let O=!0,U=!0,B=!1,Y=!0,X=!1,Se=!0,ce=!1,ot=!1,rt=!1,Ne=!1,Ke=!1,Ye=!1,_t=!0,Ct=!1;const zn="user-content-";let at=!0,Fe=!1,Ae={},Me=null;const kt=F({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Dt=null;const Rt=F({},["audio","video","img","source","image","track"]);let it=null;const It=F({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xe="http://www.w3.org/1998/Math/MathML",Ze="http://www.w3.org/2000/svg",xe="http://www.w3.org/1999/xhtml";let _e=xe,lt=!1,ct=null;const Un=F({},[Xe,Ze,xe],ft);let Je=F({},["mi","mo","mn","ms","mtext"]),Qe=F({},["annotation-xml"]);const Wn=F({},["title","style","font","a","script"]);let ze=null;const Hn=["application/xhtml+xml","text/html"],$n="text/html";let Q=null,Ce=null;const Bn=a.createElement("form"),Pt=function(o){return o instanceof RegExp||o instanceof Function},dt=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ce&&Ce===o)){if((!o||typeof o!="object")&&(o={}),o=ve(o),ze=Hn.indexOf(o.PARSER_MEDIA_TYPE)===-1?$n:o.PARSER_MEDIA_TYPE,Q=ze==="application/xhtml+xml"?ft:nt,V=fe(o,"ALLOWED_TAGS")?F({},o.ALLOWED_TAGS,Q):qe,K=fe(o,"ALLOWED_ATTR")?F({},o.ALLOWED_ATTR,Q):Ge,ct=fe(o,"ALLOWED_NAMESPACES")?F({},o.ALLOWED_NAMESPACES,ft):Un,it=fe(o,"ADD_URI_SAFE_ATTR")?F(ve(It),o.ADD_URI_SAFE_ATTR,Q):It,Dt=fe(o,"ADD_DATA_URI_TAGS")?F(ve(Rt),o.ADD_DATA_URI_TAGS,Q):Rt,Me=fe(o,"FORBID_CONTENTS")?F({},o.FORBID_CONTENTS,Q):kt,me=fe(o,"FORBID_TAGS")?F({},o.FORBID_TAGS,Q):ve({}),p=fe(o,"FORBID_ATTR")?F({},o.FORBID_ATTR,Q):ve({}),Ae=fe(o,"USE_PROFILES")?o.USE_PROFILES:!1,O=o.ALLOW_ARIA_ATTR!==!1,U=o.ALLOW_DATA_ATTR!==!1,B=o.ALLOW_UNKNOWN_PROTOCOLS||!1,Y=o.ALLOW_SELF_CLOSE_IN_ATTR!==!1,X=o.SAFE_FOR_TEMPLATES||!1,Se=o.SAFE_FOR_XML!==!1,ce=o.WHOLE_DOCUMENT||!1,Ne=o.RETURN_DOM||!1,Ke=o.RETURN_DOM_FRAGMENT||!1,Ye=o.RETURN_TRUSTED_TYPE||!1,rt=o.FORCE_BODY||!1,_t=o.SANITIZE_DOM!==!1,Ct=o.SANITIZE_NAMED_PROPS||!1,at=o.KEEP_CONTENT!==!1,Fe=o.IN_PLACE||!1,Oe=o.ALLOWED_URI_REGEXP||fn,_e=o.NAMESPACE||xe,Je=o.MATHML_TEXT_INTEGRATION_POINTS||Je,Qe=o.HTML_INTEGRATION_POINTS||Qe,H=o.CUSTOM_ELEMENT_HANDLING||{},o.CUSTOM_ELEMENT_HANDLING&&Pt(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&Pt(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(H.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),X&&(U=!1),Ke&&(Ne=!0),Ae&&(V=F({},Qt),K=[],Ae.html===!0&&(F(V,Jt),F(K,en)),Ae.svg===!0&&(F(V,pt),F(K,yt),F(K,tt)),Ae.svgFilters===!0&&(F(V,xt),F(K,yt),F(K,tt)),Ae.mathMl===!0&&(F(V,bt),F(K,tn),F(K,tt))),o.ADD_TAGS&&(typeof o.ADD_TAGS=="function"?P.tagCheck=o.ADD_TAGS:(V===qe&&(V=ve(V)),F(V,o.ADD_TAGS,Q))),o.ADD_ATTR&&(typeof o.ADD_ATTR=="function"?P.attributeCheck=o.ADD_ATTR:(K===Ge&&(K=ve(K)),F(K,o.ADD_ATTR,Q))),o.ADD_URI_SAFE_ATTR&&F(it,o.ADD_URI_SAFE_ATTR,Q),o.FORBID_CONTENTS&&(Me===kt&&(Me=ve(Me)),F(Me,o.FORBID_CONTENTS,Q)),at&&(V["#text"]=!0),ce&&F(V,["html","head","body"]),V.table&&(F(V,["tbody"]),delete me.tbody),o.TRUSTED_TYPES_POLICY){if(typeof o.TRUSTED_TYPES_POLICY.createHTML!="function")throw He('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof o.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw He('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=o.TRUSTED_TYPES_POLICY,I=b.createHTML("")}else b===void 0&&(b=Bs(c,s)),b!==null&&typeof I=="string"&&(I=b.createHTML(""));re&&re(o),Ce=o}},Lt=F({},[...pt,...xt,...Rs]),Ot=F({},[...bt,...Is]),Vn=function(o){let y=A(o);(!y||!y.tagName)&&(y={namespaceURI:_e,tagName:"template"});const k=nt(o.tagName),W=nt(y.tagName);return ct[o.namespaceURI]?o.namespaceURI===Ze?y.namespaceURI===xe?k==="svg":y.namespaceURI===Xe?k==="svg"&&(W==="annotation-xml"||Je[W]):!!Lt[k]:o.namespaceURI===Xe?y.namespaceURI===xe?k==="math":y.namespaceURI===Ze?k==="math"&&Qe[W]:!!Ot[k]:o.namespaceURI===xe?y.namespaceURI===Ze&&!Qe[W]||y.namespaceURI===Xe&&!Je[W]?!1:!Ot[k]&&(Wn[k]||!Lt[k]):!!(ze==="application/xhtml+xml"&&ct[o.namespaceURI]):!1},ge=function(o){Ue(n.removed,{element:o});try{A(o).removeChild(o)}catch{T(o)}},je=function(o,y){try{Ue(n.removed,{attribute:y.getAttributeNode(o),from:y})}catch{Ue(n.removed,{attribute:null,from:y})}if(y.removeAttribute(o),o==="is")if(Ne||Ke)try{ge(y)}catch{}else try{y.setAttribute(o,"")}catch{}},Ft=function(o){let y=null,k=null;if(rt)o="<remove></remove>"+o;else{const q=gt(o,/^[\r\n\t ]+/);k=q&&q[0]}ze==="application/xhtml+xml"&&_e===xe&&(o='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+o+"</body></html>");const W=b?b.createHTML(o):o;if(_e===xe)try{y=new S().parseFromString(W,ze)}catch{}if(!y||!y.documentElement){y=M.createDocument(_e,"template",null);try{y.documentElement.innerHTML=lt?I:W}catch{}}const ne=y.body||y.documentElement;return o&&k&&ne.insertBefore(a.createTextNode(k),ne.childNodes[0]||null),_e===xe?C.call(y,ce?"html":"body")[0]:ce?y.documentElement:ne},zt=function(o){return _.call(o.ownerDocument||o,o,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},ut=function(o){return o instanceof v&&(typeof o.nodeName!="string"||typeof o.textContent!="string"||typeof o.removeChild!="function"||!(o.attributes instanceof u)||typeof o.removeAttribute!="function"||typeof o.setAttribute!="function"||typeof o.namespaceURI!="string"||typeof o.insertBefore!="function"||typeof o.hasChildNodes!="function")},Ut=function(o){return typeof i=="function"&&o instanceof i};function be(R,o,y){et(R,k=>{k.call(n,o,y,Ce)})}const Wt=function(o){let y=null;if(be(N.beforeSanitizeElements,o,null),ut(o))return ge(o),!0;const k=Q(o.nodeName);if(be(N.uponSanitizeElement,o,{tagName:k,allowedTags:V}),Se&&o.hasChildNodes()&&!Ut(o.firstElementChild)&&oe(/<[/\w!]/g,o.innerHTML)&&oe(/<[/\w!]/g,o.textContent)||o.nodeType===Be.progressingInstruction||Se&&o.nodeType===Be.comment&&oe(/<[/\w]/g,o.data))return ge(o),!0;if(!(P.tagCheck instanceof Function&&P.tagCheck(k))&&(!V[k]||me[k])){if(!me[k]&&$t(k)&&(H.tagNameCheck instanceof RegExp&&oe(H.tagNameCheck,k)||H.tagNameCheck instanceof Function&&H.tagNameCheck(k)))return!1;if(at&&!Me[k]){const W=A(o)||o.parentNode,ne=j(o)||o.childNodes;if(ne&&W){const q=ne.length;for(let le=q-1;le>=0;--le){const ye=l(ne[le],!0);ye.__removalCount=(o.__removalCount||0)+1,W.insertBefore(ye,E(o))}}}return ge(o),!0}return o instanceof x&&!Vn(o)||(k==="noscript"||k==="noembed"||k==="noframes")&&oe(/<\/no(script|embed|frames)/i,o.innerHTML)?(ge(o),!0):(X&&o.nodeType===Be.text&&(y=o.textContent,et([z,L,$],W=>{y=We(y,W," ")}),o.textContent!==y&&(Ue(n.removed,{element:o.cloneNode()}),o.textContent=y)),be(N.afterSanitizeElements,o,null),!1)},Ht=function(o,y,k){if(_t&&(y==="id"||y==="name")&&(k in a||k in Bn))return!1;if(!(U&&!p[y]&&oe(J,y))){if(!(O&&oe(G,y))){if(!(P.attributeCheck instanceof Function&&P.attributeCheck(y,o))){if(!K[y]||p[y]){if(!($t(o)&&(H.tagNameCheck instanceof RegExp&&oe(H.tagNameCheck,o)||H.tagNameCheck instanceof Function&&H.tagNameCheck(o))&&(H.attributeNameCheck instanceof RegExp&&oe(H.attributeNameCheck,y)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(y,o))||y==="is"&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&oe(H.tagNameCheck,k)||H.tagNameCheck instanceof Function&&H.tagNameCheck(k))))return!1}else if(!it[y]){if(!oe(Oe,We(k,ee,""))){if(!((y==="src"||y==="xlink:href"||y==="href")&&o!=="script"&&_s(k,"data:")===0&&Dt[o])){if(!(B&&!oe(se,We(k,ee,"")))){if(k)return!1}}}}}}}return!0},$t=function(o){return o!=="annotation-xml"&&gt(o,ie)},Bt=function(o){be(N.beforeSanitizeAttributes,o,null);const{attributes:y}=o;if(!y||ut(o))return;const k={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:K,forceKeepAttr:void 0};let W=y.length;for(;W--;){const ne=y[W],{name:q,namespaceURI:le,value:ye}=ne,ke=Q(q),mt=ye;let te=q==="value"?mt:Cs(mt);if(k.attrName=ke,k.attrValue=te,k.keepAttr=!0,k.forceKeepAttr=void 0,be(N.uponSanitizeAttribute,o,k),te=k.attrValue,Ct&&(ke==="id"||ke==="name")&&(je(q,o),te=zn+te),Se&&oe(/((--!?|])>)|<\/(style|title|textarea)/i,te)){je(q,o);continue}if(ke==="attributename"&&gt(te,"href")){je(q,o);continue}if(k.forceKeepAttr)continue;if(!k.keepAttr){je(q,o);continue}if(!Y&&oe(/\/>/i,te)){je(q,o);continue}X&&et([z,L,$],qt=>{te=We(te,qt," ")});const Vt=Q(o.nodeName);if(!Ht(Vt,ke,te)){je(q,o);continue}if(b&&typeof c=="object"&&typeof c.getAttributeType=="function"&&!le)switch(c.getAttributeType(Vt,ke)){case"TrustedHTML":{te=b.createHTML(te);break}case"TrustedScriptURL":{te=b.createScriptURL(te);break}}if(te!==mt)try{le?o.setAttributeNS(le,q,te):o.setAttribute(q,te),ut(o)?ge(o):Zt(n.removed)}catch{je(q,o)}}be(N.afterSanitizeAttributes,o,null)},qn=function R(o){let y=null;const k=zt(o);for(be(N.beforeSanitizeShadowDOM,o,null);y=k.nextNode();)be(N.uponSanitizeShadowNode,y,null),Wt(y),Bt(y),y.content instanceof f&&R(y.content);be(N.afterSanitizeShadowDOM,o,null)};return n.sanitize=function(R){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=null,k=null,W=null,ne=null;if(lt=!R,lt&&(R="<!-->"),typeof R!="string"&&!Ut(R))if(typeof R.toString=="function"){if(R=R.toString(),typeof R!="string")throw He("dirty is not a string, aborting")}else throw He("toString is not a function");if(!n.isSupported)return R;if(ot||dt(o),n.removed=[],typeof R=="string"&&(Fe=!1),Fe){if(R.nodeName){const ye=Q(R.nodeName);if(!V[ye]||me[ye])throw He("root node is forbidden and cannot be sanitized in-place")}}else if(R instanceof i)y=Ft("<!---->"),k=y.ownerDocument.importNode(R,!0),k.nodeType===Be.element&&k.nodeName==="BODY"||k.nodeName==="HTML"?y=k:y.appendChild(k);else{if(!Ne&&!X&&!ce&&R.indexOf("<")===-1)return b&&Ye?b.createHTML(R):R;if(y=Ft(R),!y)return Ne?null:Ye?I:""}y&&rt&&ge(y.firstChild);const q=zt(Fe?R:y);for(;W=q.nextNode();)Wt(W),Bt(W),W.content instanceof f&&qn(W.content);if(Fe)return R;if(Ne){if(Ke)for(ne=w.call(y.ownerDocument);y.firstChild;)ne.appendChild(y.firstChild);else ne=y;return(K.shadowroot||K.shadowrootmode)&&(ne=D.call(r,ne,!0)),ne}let le=ce?y.outerHTML:y.innerHTML;return ce&&V["!doctype"]&&y.ownerDocument&&y.ownerDocument.doctype&&y.ownerDocument.doctype.name&&oe(gn,y.ownerDocument.doctype.name)&&(le="<!DOCTYPE "+y.ownerDocument.doctype.name+`>
`+le),X&&et([z,L,$],ye=>{le=We(le,ye," ")}),b&&Ye?b.createHTML(le):le},n.setConfig=function(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};dt(R),ot=!0},n.clearConfig=function(){Ce=null,ot=!1},n.isValidAttribute=function(R,o,y){Ce||dt({});const k=Q(R),W=Q(o);return Ht(k,W,y)},n.addHook=function(R,o){typeof o=="function"&&Ue(N[R],o)},n.removeHook=function(R,o){if(o!==void 0){const y=As(N[R],o);return y===-1?void 0:Ms(N[R],y,1)[0]}return Zt(N[R])},n.removeHooks=function(R){N[R]=[]},n.removeAllHooks=function(){N=sn()},n}var xn=pn();const ue=({children:t,level:n=1,className:a="",enableMath:r=!0})=>{const s=g.useRef(null);g.useEffect(()=>{if(!r)return;const i=s.current,x=window.MathJax;if(!(!i||!x))try{x.typesetPromise?x.typesetPromise([i]).catch(()=>{}):x.typeset&&x.typeset([i])}catch{}},[t,r]);const d=`${{1:"text-4xl font-bold mb-4",2:"text-3xl font-bold mb-3",3:"text-2xl font-semibold mb-3",4:"text-xl font-semibold mb-2",5:"text-lg font-semibold mb-2",6:"text-base font-semibold mb-2"}[n]} ${r?"mathjax-process":""} ${a}`.trim();if(typeof t=="string"){const i=xn.sanitize(t,{USE_PROFILES:{html:!0}});switch(n){case 1:return e.jsx("h1",{ref:s,className:d,dangerouslySetInnerHTML:{__html:i}});case 2:return e.jsx("h2",{ref:s,className:d,dangerouslySetInnerHTML:{__html:i}});case 3:return e.jsx("h3",{ref:s,className:d,dangerouslySetInnerHTML:{__html:i}});case 4:return e.jsx("h4",{ref:s,className:d,dangerouslySetInnerHTML:{__html:i}});case 5:return e.jsx("h5",{ref:s,className:d,dangerouslySetInnerHTML:{__html:i}});case 6:return e.jsx("h6",{ref:s,className:d,dangerouslySetInnerHTML:{__html:i}});default:return e.jsx("h1",{ref:s,className:d,dangerouslySetInnerHTML:{__html:i}})}}switch(n){case 1:return e.jsx("h1",{ref:s,className:d,children:t});case 2:return e.jsx("h2",{ref:s,className:d,children:t});case 3:return e.jsx("h3",{ref:s,className:d,children:t});case 4:return e.jsx("h4",{ref:s,className:d,children:t});case 5:return e.jsx("h5",{ref:s,className:d,children:t});case 6:return e.jsx("h6",{ref:s,className:d,children:t});default:return e.jsx("h1",{ref:s,className:d,children:t})}},on=t=>{let n;const a=new Set,r=(m,u)=>{const v=typeof m=="function"?m(n):m;if(!Object.is(v,n)){const S=n;n=u??(typeof v!="object"||v===null)?v:Object.assign({},n,v),a.forEach(c=>c(n,S))}},s=()=>n,i={setState:r,getState:s,getInitialState:()=>x,subscribe:m=>(a.add(m),()=>a.delete(m))},x=n=t(r,s,i);return i},Vs=t=>t?on(t):on,qs=t=>t;function Gs(t,n=qs){const a=we.useSyncExternalStore(t.subscribe,we.useCallback(()=>n(t.getState()),[t,n]),we.useCallback(()=>n(t.getInitialState()),[t,n]));return we.useDebugValue(a),a}const rn=t=>{const n=Vs(t),a=r=>Gs(n,r);return Object.assign(a,n),a},Ks=t=>t?rn(t):rn;let an={};const Ys=Ks((t,n)=>({variables:{},initialized:!1,setVariable:(a,r)=>{t(s=>({variables:{...s.variables,[a]:r}}))},setVariables:a=>{t(r=>({variables:{...r.variables,...a}}))},getVariable:(a,r)=>n().variables[a]??r,initialize:a=>{n().initialized||(an={...a},t({variables:{...a},initialized:!0}))},reset:()=>{t({variables:{...an}})}})),Xs={},Zs=()=>{const t={};for(const[n,a]of Object.entries(Xs))t[n]=a.defaultValue;return t},Z=({children:t,className:n="",enableMath:a=!0})=>{const r=g.useRef(null);if(g.useEffect(()=>{if(!a)return;const s=r.current,f=window.MathJax;if(!(!s||!f))try{f.typesetPromise?f.typesetPromise([s]).catch(()=>{}):f.typeset&&f.typeset([s])}catch{}},[t,a]),typeof t=="string"){const s=xn.sanitize(t,{USE_PROFILES:{html:!0}});return e.jsx("p",{ref:r,className:`text-base ${a?"mathjax-process":""} ${n}`,dangerouslySetInnerHTML:{__html:s}})}return e.jsx("p",{ref:r,className:`text-base ${a?"mathjax-process":""} ${n}`,children:t})},Js=()=>{const t=g.useRef(null),[n,a]=g.useState(0),[r,s]=g.useState(!1),[f,d]=g.useState(!1),i={a:2,b:1,c:0,d:1},x=[{x:1,y:.5,color:"#6366f1",label:"v₁"},{x:.5,y:1,color:"#f97316",label:"v₂"},{x:1,y:0,color:"#22c55e",label:"e₁",isEigen:!0}],m=(S,c,h)=>{const l=S+h*(i.a*S+i.b*c-S),T=c+h*(i.c*S+i.d*c-c);return{x:l,y:T}};g.useEffect(()=>{const S=t.current;if(!S)return;const c=S.getContext("2d");if(!c)return;const h=S.width,l=S.height,T=60,E=h/2,j=l/2;c.fillStyle="#fafafa",c.fillRect(0,0,h,l),c.strokeStyle="#e5e7eb",c.lineWidth=1;for(let b=-5;b<=5;b++)c.beginPath(),c.moveTo(E+b*T,0),c.lineTo(E+b*T,l),c.stroke(),c.beginPath(),c.moveTo(0,j+b*T),c.lineTo(h,j+b*T),c.stroke();c.strokeStyle="#9ca3af",c.lineWidth=2,c.beginPath(),c.moveTo(0,j),c.lineTo(h,j),c.stroke(),c.beginPath(),c.moveTo(E,0),c.lineTo(E,l),c.stroke();const A=(b,I,M,_,w,C=3)=>{const N=M-b,z=_-I,L=Math.atan2(z,N);c.strokeStyle=w,c.fillStyle=w,c.lineWidth=C,c.beginPath(),c.moveTo(b,I),c.lineTo(M,_),c.stroke(),c.beginPath(),c.moveTo(M,_),c.lineTo(M-10*Math.cos(L-Math.PI/6),_-10*Math.sin(L-Math.PI/6)),c.lineTo(M-10*Math.cos(L+Math.PI/6),_-10*Math.sin(L+Math.PI/6)),c.closePath(),c.fill()};x.forEach(b=>{if(b.isEigen&&!f)return;const I=m(b.x,b.y,n);n>0&&A(E,j,E+b.x*T,j-b.y*T,b.color+"40",2),A(E,j,E+I.x*T,j-I.y*T,b.color,3),c.fillStyle=b.color,c.font="bold 14px system-ui",c.fillText(b.label,E+I.x*T+10,j-I.y*T-10)}),c.fillStyle="#6b7280",c.font="13px system-ui",n===0?c.fillText("Click 'Transform' to apply the matrix",10,l-10):n===1&&c.fillText("Notice: green vector only stretched, not rotated!",10,l-10)},[n,f,x]);const u=()=>{if(r)return;s(!0),d(!0);let S=0;const c=()=>{if(S+=.02,S>=1){a(1),s(!1);return}a(S),requestAnimationFrame(c)};c()},v=()=>{a(0),d(!1)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("canvas",{ref:t,width:350,height:300,className:"border border-border rounded-lg w-full"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:u,disabled:r||n===1,className:"px-4 py-2 bg-primary text-primary-foreground rounded-md font-medium text-sm hover:opacity-90 disabled:opacity-50 transition-opacity",children:"Transform"}),e.jsx("button",{onClick:v,disabled:r||n===0,className:"px-4 py-2 bg-muted text-muted-foreground rounded-md font-medium text-sm hover:bg-muted/80 disabled:opacity-50 transition-colors",children:"Reset"})]})]})},Qs=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{level:1,children:"What Makes Eigenvalues Special?"}),e.jsxs(Z,{className:"text-lg leading-relaxed",children:["Imagine you have a transformation that stretches, rotates, or skews space. When you apply this transformation to most vectors, they change both their",e.jsx("strong",{children:" direction"})," and their ",e.jsx("strong",{children:"length"}),"."]}),e.jsxs(Z,{className:"leading-relaxed",children:["But here's the fascinating part: for every transformation, there exist some",e.jsx("em",{children:" special vectors"})," that ",e.jsx("strong",{children:"don't change direction"})," — they only get stretched or shrunk along their original line."]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border my-4",children:[e.jsx(Z,{className:"font-medium text-foreground mb-2",children:"Key Insight:"}),e.jsxs(Z,{children:["These special vectors are called ",e.jsx("strong",{className:"text-primary",children:"eigenvectors"}),", and the factor by which they stretch is called the ",e.jsx("strong",{className:"text-primary",children:"eigenvalue"}),"."]})]}),e.jsxs(Z,{className:"leading-relaxed",children:["In the visualization on the right, watch what happens when we apply a matrix transformation. The ",e.jsx("span",{style:{color:"#6366f1"},children:"purple"})," and"," ",e.jsx("span",{style:{color:"#f97316"},children:"orange"})," vectors rotate AND stretch. But the ",e.jsx("span",{style:{color:"#22c55e"},children:"green"})," vector? It only stretches — that's an eigenvector!"]})]}),eo=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{level:3,children:"Interactive Transformation"}),e.jsx(Z,{className:"text-muted-foreground text-sm",children:'Click "Transform" to see how the matrix affects different vectors.'}),e.jsx(Js,{})]});function bn(t,[n,a]){return Math.min(a,Math.max(n,t))}function to(t){const n=g.useRef({value:t,previous:t});return g.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var yn=["PageUp","PageDown"],vn=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Tn={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Le="Slider",[St,no,so]=rs(Le),[En,Po]=as(Le,[so]),[oo,st]=En(Le),Sn=g.forwardRef((t,n)=>{const{name:a,min:r=0,max:s=100,step:f=1,orientation:d="horizontal",disabled:i=!1,minStepsBetweenThumbs:x=0,defaultValue:m=[r],value:u,onValueChange:v=()=>{},onValueCommit:S=()=>{},inverted:c=!1,form:h,...l}=t,T=g.useRef(new Set),E=g.useRef(0),A=d==="horizontal"?ro:ao,[b=[],I]=is({prop:u,defaultProp:m,onChange:N=>{var L;(L=[...T.current][E.current])==null||L.focus(),v(N)}}),M=g.useRef(b);function _(N){const z=mo(b,N);D(N,z)}function w(N){D(N,E.current)}function C(){const N=M.current[E.current];b[E.current]!==N&&S(b)}function D(N,z,{commit:L}={commit:!1}){const $=po(f),J=xo(Math.round((N-r)/f)*f+r,$),G=bn(J,[r,s]);I((se=[])=>{const ee=co(se,G,z);if(go(ee,x*f)){E.current=ee.indexOf(G);const ie=String(ee)!==String(se);return ie&&L&&S(ee),ie?ee:se}else return se})}return e.jsx(oo,{scope:t.__scopeSlider,name:a,disabled:i,min:r,max:s,valueIndexToChangeRef:E,thumbs:T.current,values:b,orientation:d,form:h,children:e.jsx(St.Provider,{scope:t.__scopeSlider,children:e.jsx(St.Slot,{scope:t.__scopeSlider,children:e.jsx(A,{"aria-disabled":i,"data-disabled":i?"":void 0,...l,ref:n,onPointerDown:De(l.onPointerDown,()=>{i||(M.current=b)}),min:r,max:s,inverted:c,onSlideStart:i?void 0:_,onSlideMove:i?void 0:w,onSlideEnd:i?void 0:C,onHomeKeyDown:()=>!i&&D(r,0,{commit:!0}),onEndKeyDown:()=>!i&&D(s,b.length-1,{commit:!0}),onStepKeyDown:({event:N,direction:z})=>{if(!i){const J=yn.includes(N.key)||N.shiftKey&&vn.includes(N.key)?10:1,G=E.current,se=b[G],ee=f*J*z;D(se+ee,G,{commit:!0})}}})})})})});Sn.displayName=Le;var[wn,jn]=En(Le,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ro=g.forwardRef((t,n)=>{const{min:a,max:r,dir:s,inverted:f,onSlideStart:d,onSlideMove:i,onSlideEnd:x,onStepKeyDown:m,...u}=t,[v,S]=g.useState(null),c=Pe(n,A=>S(A)),h=g.useRef(void 0),l=ls(s),T=l==="ltr",E=T&&!f||!T&&f;function j(A){const b=h.current||v.getBoundingClientRect(),I=[0,b.width],_=At(I,E?[a,r]:[r,a]);return h.current=b,_(A-b.left)}return e.jsx(wn,{scope:t.__scopeSlider,startEdge:E?"left":"right",endEdge:E?"right":"left",direction:E?1:-1,size:"width",children:e.jsx(Nn,{dir:l,"data-orientation":"horizontal",...u,ref:c,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:A=>{const b=j(A.clientX);d==null||d(b)},onSlideMove:A=>{const b=j(A.clientX);i==null||i(b)},onSlideEnd:()=>{h.current=void 0,x==null||x()},onStepKeyDown:A=>{const I=Tn[E?"from-left":"from-right"].includes(A.key);m==null||m({event:A,direction:I?-1:1})}})})}),ao=g.forwardRef((t,n)=>{const{min:a,max:r,inverted:s,onSlideStart:f,onSlideMove:d,onSlideEnd:i,onStepKeyDown:x,...m}=t,u=g.useRef(null),v=Pe(n,u),S=g.useRef(void 0),c=!s;function h(l){const T=S.current||u.current.getBoundingClientRect(),E=[0,T.height],A=At(E,c?[r,a]:[a,r]);return S.current=T,A(l-T.top)}return e.jsx(wn,{scope:t.__scopeSlider,startEdge:c?"bottom":"top",endEdge:c?"top":"bottom",size:"height",direction:c?1:-1,children:e.jsx(Nn,{"data-orientation":"vertical",...m,ref:v,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:l=>{const T=h(l.clientY);f==null||f(T)},onSlideMove:l=>{const T=h(l.clientY);d==null||d(T)},onSlideEnd:()=>{S.current=void 0,i==null||i()},onStepKeyDown:l=>{const E=Tn[c?"from-bottom":"from-top"].includes(l.key);x==null||x({event:l,direction:E?-1:1})}})})}),Nn=g.forwardRef((t,n)=>{const{__scopeSlider:a,onSlideStart:r,onSlideMove:s,onSlideEnd:f,onHomeKeyDown:d,onEndKeyDown:i,onStepKeyDown:x,...m}=t,u=st(Le,a);return e.jsx(Ve.span,{...m,ref:n,onKeyDown:De(t.onKeyDown,v=>{v.key==="Home"?(d(v),v.preventDefault()):v.key==="End"?(i(v),v.preventDefault()):yn.concat(vn).includes(v.key)&&(x(v),v.preventDefault())}),onPointerDown:De(t.onPointerDown,v=>{const S=v.target;S.setPointerCapture(v.pointerId),v.preventDefault(),u.thumbs.has(S)?S.focus():r(v)}),onPointerMove:De(t.onPointerMove,v=>{v.target.hasPointerCapture(v.pointerId)&&s(v)}),onPointerUp:De(t.onPointerUp,v=>{const S=v.target;S.hasPointerCapture(v.pointerId)&&(S.releasePointerCapture(v.pointerId),f(v))})})}),An="SliderTrack",Mn=g.forwardRef((t,n)=>{const{__scopeSlider:a,...r}=t,s=st(An,a);return e.jsx(Ve.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:n})});Mn.displayName=An;var wt="SliderRange",_n=g.forwardRef((t,n)=>{const{__scopeSlider:a,...r}=t,s=st(wt,a),f=jn(wt,a),d=g.useRef(null),i=Pe(n,d),x=s.values.length,m=s.values.map(S=>Dn(S,s.min,s.max)),u=x>1?Math.min(...m):0,v=100-Math.max(...m);return e.jsx(Ve.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:i,style:{...t.style,[f.startEdge]:u+"%",[f.endEdge]:v+"%"}})});_n.displayName=wt;var jt="SliderThumb",Cn=g.forwardRef((t,n)=>{const a=no(t.__scopeSlider),[r,s]=g.useState(null),f=Pe(n,i=>s(i)),d=g.useMemo(()=>r?a().findIndex(i=>i.ref.current===r):-1,[a,r]);return e.jsx(io,{...t,ref:f,index:d})}),io=g.forwardRef((t,n)=>{const{__scopeSlider:a,index:r,name:s,...f}=t,d=st(jt,a),i=jn(jt,a),[x,m]=g.useState(null),u=Pe(n,j=>m(j)),v=x?d.form||!!x.closest("form"):!0,S=cs(x),c=d.values[r],h=c===void 0?0:Dn(c,d.min,d.max),l=uo(r,d.values.length),T=S==null?void 0:S[i.size],E=T?ho(T,h,i.direction):0;return g.useEffect(()=>{if(x)return d.thumbs.add(x),()=>{d.thumbs.delete(x)}},[x,d.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[i.startEdge]:`calc(${h}% + ${E}px)`},children:[e.jsx(St.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(Ve.span,{role:"slider","aria-label":t["aria-label"]||l,"aria-valuemin":d.min,"aria-valuenow":c,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...f,ref:u,style:c===void 0?{display:"none"}:t.style,onFocus:De(t.onFocus,()=>{d.valueIndexToChangeRef.current=r})})}),v&&e.jsx(kn,{name:s??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:c},r)]})});Cn.displayName=jt;var lo="RadioBubbleInput",kn=g.forwardRef(({__scopeSlider:t,value:n,...a},r)=>{const s=g.useRef(null),f=Pe(s,r),d=to(n);return g.useEffect(()=>{const i=s.current;if(!i)return;const x=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(x,"value").set;if(d!==n&&u){const v=new Event("input",{bubbles:!0});u.call(i,n),i.dispatchEvent(v)}},[d,n]),e.jsx(Ve.input,{style:{display:"none"},...a,ref:f,defaultValue:n})});kn.displayName=lo;function co(t=[],n,a){const r=[...t];return r[a]=n,r.sort((s,f)=>s-f)}function Dn(t,n,a){const f=100/(a-n)*(t-n);return bn(f,[0,100])}function uo(t,n){return n>2?`Value ${t+1} of ${n}`:n===2?["Minimum","Maximum"][t]:void 0}function mo(t,n){if(t.length===1)return 0;const a=t.map(s=>Math.abs(s-n)),r=Math.min(...a);return a.indexOf(r)}function ho(t,n,a){const r=t/2,f=At([0,50],[0,r]);return(r-f(n)*a)*a}function fo(t){return t.slice(0,-1).map((n,a)=>t[a+1]-n)}function go(t,n){if(n>0){const a=fo(t);return Math.min(...a)>=n}return!0}function At(t,n){return a=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const r=(n[1]-n[0])/(t[1]-t[0]);return n[0]+r*(a-t[0])}}function po(t){return(String(t).split(".")[1]||"").length}function xo(t,n){const a=Math.pow(10,n);return Math.round(t*a)/a}var Rn=Sn,bo=Mn,yo=_n,vo=Cn;const Mt=g.forwardRef(({className:t,...n},a)=>e.jsxs(Rn,{ref:a,className:Re("relative flex w-full touch-none select-none items-center",t),...n,children:[e.jsx(bo,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(yo,{className:"absolute h-full bg-primary"})}),e.jsx(vo,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Mt.displayName=Rn.displayName;const To=({matrix:t})=>{const n=g.useRef(null),a=(r,s)=>({x:t.a*r+t.b*s,y:t.c*r+t.d*s});return g.useEffect(()=>{const r=n.current;if(!r)return;const s=r.getContext("2d");if(!s)return;const f=r.width,d=r.height,i=50,x=f/2,m=d/2;s.fillStyle="#fafafa",s.fillRect(0,0,f,d),s.strokeStyle="#e5e7eb",s.lineWidth=1;for(let c=-4;c<=4;c++){const h=a(c,-4),l=a(c,4);s.beginPath(),s.moveTo(x+h.x*i,m-h.y*i),s.lineTo(x+l.x*i,m-l.y*i),s.stroke()}for(let c=-4;c<=4;c++){const h=a(-4,c),l=a(4,c);s.beginPath(),s.moveTo(x+h.x*i,m-h.y*i),s.lineTo(x+l.x*i,m-l.y*i),s.stroke()}s.strokeStyle="#9ca3af",s.lineWidth=2,s.beginPath(),s.moveTo(0,m),s.lineTo(f,m),s.stroke(),s.beginPath(),s.moveTo(x,0),s.lineTo(x,d),s.stroke();const u=(c,h,l,T,E,j=2)=>{const b=l-c,I=T-h;if(Math.sqrt(b*b+I*I)<5)return;const _=Math.atan2(I,b);s.strokeStyle=E,s.fillStyle=E,s.lineWidth=j,s.beginPath(),s.moveTo(c,h),s.lineTo(l,T),s.stroke(),s.beginPath(),s.moveTo(l,T),s.lineTo(l-8*Math.cos(_-Math.PI/6),T-8*Math.sin(_-Math.PI/6)),s.lineTo(l-8*Math.cos(_+Math.PI/6),T-8*Math.sin(_+Math.PI/6)),s.closePath(),s.fill()};[{x:1,y:0,color:"#22c55e",label:"î"},{x:0,y:1,color:"#3b82f6",label:"ĵ"}].forEach(c=>{const h=a(c.x,c.y);u(x,m,x+c.x*i,m-c.y*i,c.color+"40",2),u(x,m,x+h.x*i,m-h.y*i,c.color,3),s.fillStyle=c.color,s.font="bold 14px system-ui",s.fillText(c.label,x+h.x*i+8,m-h.y*i-8)});const S=t.a*t.d-t.b*t.c;s.fillStyle="#6b7280",s.font="13px system-ui",s.fillText(`det(A) = ${S.toFixed(2)}`,10,d-30),S<0?(s.fillStyle="#ef4444",s.fillText("Orientation flipped!",10,d-10)):Math.abs(S)<.1&&(s.fillStyle="#f97316",s.fillText("Space is being squished!",10,d-10))},[t]),e.jsx("canvas",{ref:n,width:380,height:320,className:"border border-border rounded-lg w-full"})},Eo=()=>{const[t,n]=g.useState({a:1,b:0,c:0,d:1}),a=(s,f)=>{n(d=>({...d,[s]:f}))},r=[{name:"Identity",values:{a:1,b:0,c:0,d:1}},{name:"Scale 2x",values:{a:2,b:0,c:0,d:2}},{name:"Rotate 45°",values:{a:.71,b:-.71,c:.71,d:.71}},{name:"Shear",values:{a:1,b:1,c:0,d:1}},{name:"Reflection",values:{a:-1,b:0,c:0,d:1}}];return e.jsxs(un,{ratio:"1:1",gap:"lg",children:[e.jsx(de,{id:"transform-controls",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{level:2,children:"Explore Transformations"}),e.jsxs(Z,{className:"leading-relaxed",children:["A 2×2 matrix transforms every point in space. Adjust the sliders and watch how the ",e.jsx("span",{style:{color:"#22c55e"},children:"green (î)"})," and"," ",e.jsx("span",{style:{color:"#3b82f6"},children:"blue (ĵ)"})," basis vectors change."]}),e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:e.jsxs("div",{className:"text-center font-mono",children:[e.jsx("span",{className:"text-lg",children:"A = "}),e.jsxs("span",{className:"text-lg",children:["[ ",t.a.toFixed(1)," , ",t.b.toFixed(1)," ]"]}),e.jsx("br",{}),e.jsxs("span",{className:"text-lg ml-8",children:["[ ",t.c.toFixed(1)," , ",t.d.toFixed(1)," ]"]})]})}),e.jsx("div",{className:"space-y-4",children:["a","b","c","d"].map(s=>e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium flex justify-between",children:[e.jsx("span",{children:s}),e.jsx("span",{className:"text-muted-foreground",children:t[s].toFixed(1)})]}),e.jsx(Mt,{value:[t[s]],onValueChange:([f])=>a(s,f),min:-2,max:2,step:.1,className:"mt-2"})]},s))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Try these presets:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(s=>e.jsx("button",{onClick:()=>n(s.values),className:"px-3 py-1.5 text-sm bg-muted hover:bg-muted/80 rounded-md transition-colors",children:s.name},s.name))})]})]})}),e.jsx(de,{id:"transform-viz",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{level:3,children:"Live Transformation"}),e.jsx(To,{matrix:t}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"What to observe:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"The grid shows how entire space transforms"}),e.jsx("li",{children:'Try "Shear" - one basis vector stays fixed!'}),e.jsx("li",{children:"When det ≈ 0, space squishes to a line"})]})]})]})})]})},In=({latex:t,colorMap:n={},activeTerm:a,onTermHover:r,onTermClick:s,className:f=""})=>{const d=g.useRef(null),{isEditor:i}=Nt(),{isEditing:x,openEquationEditor:m,pendingEdits:u}=ds(),[v,S]=g.useState(!1),c=g.useCallback(()=>{if(!d.current)return"";const w=d.current.closest("[data-section-id]");return`equation-${(w==null?void 0:w.getAttribute("data-section-id"))||"unknown"}-${t.substring(0,20)}`},[t]),h=g.useMemo(()=>{if(!x||!i||!d.current)return null;c();const w=d.current.closest("[data-section-id]"),C=(w==null?void 0:w.getAttribute("data-section-id"))||"";return[...u].reverse().find(N=>N.type==="equation"&&N.sectionId===C&&N.originalLatex===t)},[x,i,u,t,c]),l=h?h.newLatex:t,T=h&&h.colorMap?h.colorMap:n,E=g.useMemo(()=>{let w=l;const C=/\\clr\{([^}]+)\}\{([^}]+)\}/g;return w=w.replace(C,(D,N,z)=>{const L=T[N];return L?`\\htmlClass{term-${N}}{\\textcolor{${L}}{${z}}}`:z}),w},[l,T]),j=g.useCallback(w=>{if(!w)return null;const D=Array.from(w.classList).find(N=>N.startsWith("term-"));return D?D.replace("term-",""):null},[]),A=g.useCallback(w=>!w||!(w instanceof Element)?null:w.className&&w.className.includes&&w.className.includes("term-")?w:w.closest('[class*="term-"]'),[]);g.useEffect(()=>{if(d.current)try{us.render(E,d.current,{throwOnError:!1,trust:!0,output:"html"})}catch(w){console.error("KaTeX rendering error:",w),d.current.textContent=l}},[E,l]),g.useEffect(()=>{if(!d.current)return;d.current.querySelectorAll('[class*="term-"]').forEach(D=>{const N=D,z=j(N);if(!z)return;const L=a===z,$=a!=null;N.style.transition="opacity 0.15s ease",N.style.cursor=r||s?"pointer":"default",$?N.style.opacity=L?"1":"0.35":N.style.opacity="1"})},[E,a,r,s,j]);const b=g.useCallback(w=>{if(!r)return;const C=A(w.target);if(C){const D=j(C);D&&r(D)}},[r,A,j]),I=g.useCallback(w=>{if(!r)return;const C=A(w.target),D=A(w.relatedTarget);C&&!D&&r(null)},[r,A]),M=g.useCallback(w=>{if(!s)return;const C=A(w.target);if(C){const D=j(C);D&&(w.stopPropagation(),s(D))}},[s,A,j]),_=g.useCallback(w=>{var N;w.stopPropagation(),w.preventDefault();const C=(N=d.current)==null?void 0:N.closest("[data-section-id]"),D=(C==null?void 0:C.getAttribute("data-section-id"))||"";m(l,T,D,c())},[l,T,m,c]);return e.jsxs("span",{className:Re("relative inline-block",i&&x&&"group"),onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),children:[e.jsx("span",{ref:d,className:Re("equation-display inline-block",f,i&&x&&"cursor-pointer hover:outline hover:outline-2 hover:outline-dashed hover:outline-offset-2 hover:outline-[#3cc499] rounded transition-all duration-150"),onMouseOver:b,onMouseOut:I,onClick:i&&x?_:M}),i&&x&&v&&e.jsx("button",{onClick:_,className:"absolute -top-2 -right-2 w-6 h-6 bg-[#3cc499] text-white rounded-full shadow-lg flex items-center justify-center text-xs hover:bg-[#3cc499]/90 transition-all duration-150 z-10",title:"Edit equation",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})},Pn=g.createContext(null),Ln=()=>{const t=g.useContext(Pn);if(!t)throw new Error("useColoredEquation must be used within ColoredEquationProvider");return t},On=({colorMap:t,children:n,className:a=""})=>{const[r,s]=g.useState(null),f=ln(),{isEditor:d}=Nt(),i=(f==null?void 0:f.pendingEdits)||[],x=(f==null?void 0:f.isEditing)&&d,m=we.useMemo(()=>{if(!x||i.length===0)return t;const u=[...i].reverse().find(v=>v.type==="equation"&&v.colorMap&&Object.keys(v.colorMap).length>0);return(u==null?void 0:u.colorMap)||t},[x,i,t]);return e.jsx(Pn.Provider,{value:{activeTerm:r,setActiveTerm:s,colorMap:m},children:e.jsx("div",{className:Re("colored-equation-provider",a),children:n})})},Fn=({latex:t,className:n=""})=>{const{activeTerm:a,setActiveTerm:r,colorMap:s}=Ln();return e.jsx("span",{className:Re("inline-block align-baseline",n),children:e.jsx(In,{latex:t,colorMap:s,activeTerm:a,onTermHover:r,className:"inline [&_.katex]:text-[1em]"})})},pe=({name:t,children:n,className:a="",sectionId:r=""})=>{const{activeTerm:s,setActiveTerm:f,colorMap:d}=Ln(),i=d[t],x=s===t,m=s!==null,[u,v]=we.useState(!1),[S,c]=we.useState(""),h=we.useRef(null),{isEditor:l}=Nt(),T=ln(),E=(T==null?void 0:T.isEditing)&&l,j=T==null?void 0:T.addTextEdit;let A=!1;try{A=ms().isParentEditable}catch{}const b=_=>{A||!E||u||(_.stopPropagation(),h.current&&(c(h.current.innerText),v(!0),setTimeout(()=>{if(h.current){h.current.focus();const w=document.createRange();w.selectNodeContents(h.current);const C=window.getSelection();C==null||C.removeAllRanges(),C==null||C.addRange(w)}},0)))},I=()=>{if(!h.current)return;const _=h.current.innerText;_!==S&&j&&j({sectionId:r,elementPath:`HighlightedTerm[${t}]`,originalText:S,newText:_}),v(!1)},M=_=>{var w;_.key==="Enter"&&(_.preventDefault(),(w=h.current)==null||w.blur()),_.key==="Escape"&&(h.current&&(h.current.innerText=S),v(!1))};return e.jsx("span",{ref:h,className:Re("cursor-pointer transition-all duration-150 rounded px-0.5",E&&!u&&!A&&"hover:outline hover:outline-2 hover:outline-dashed hover:outline-offset-1 hover:outline-[#3cc499]",u&&"outline outline-2 outline-offset-1 outline-[#3cc499]",a),style:{color:i,opacity:m?x?1:.35:1,backgroundColor:u?`${i}30`:x?`${i}20`:"transparent"},contentEditable:u,suppressContentEditableWarning:!0,onMouseEnter:()=>!u&&f(t),onMouseLeave:()=>!u&&f(null),onClick:b,onBlur:I,onKeyDown:M,children:n})},So=()=>{const t=g.useRef(null),[n,a]=g.useState(0),[r,s]=g.useState(!1),f={a:2,b:1,c:0,d:1},d=[0,3*Math.PI/4],i=[2,1],x=(h,l)=>({x:f.a*h+f.b*l,y:f.c*h+f.d*l}),u=(()=>{for(let l=0;l<d.length;l++){let T=Math.abs(n-d[l]);if(T>Math.PI&&(T=2*Math.PI-T),T<.15)return{index:l,eigenvalue:i[l]}}return null})();g.useEffect(()=>{const h=t.current;if(!h)return;const l=h.getContext("2d");if(!l)return;const T=h.width,E=h.height,j=80,A=T/2,b=E/2;l.fillStyle="#fafafa",l.fillRect(0,0,T,E),l.strokeStyle="#e5e7eb",l.lineWidth=1;for(let D=-3;D<=3;D++)l.beginPath(),l.moveTo(A+D*j,0),l.lineTo(A+D*j,E),l.stroke(),l.beginPath(),l.moveTo(0,b+D*j),l.lineTo(T,b+D*j),l.stroke();l.strokeStyle="#9ca3af",l.lineWidth=2,l.beginPath(),l.moveTo(0,b),l.lineTo(T,b),l.stroke(),l.beginPath(),l.moveTo(A,0),l.lineTo(A,E),l.stroke(),l.setLineDash([5,5]),l.strokeStyle="#22c55e50",l.lineWidth=2,d.forEach(D=>{l.beginPath(),l.moveTo(A-150*Math.cos(D),b+150*Math.sin(D)),l.lineTo(A+150*Math.cos(D),b-150*Math.sin(D)),l.stroke()}),l.setLineDash([]);const I=Math.cos(n),M=Math.sin(n),_=1.5,w=x(I*_,M*_),C=(D,N,z,L,$,J=3)=>{const se=z-D,ee=L-N,ie=Math.atan2(ee,se);l.strokeStyle=$,l.fillStyle=$,l.lineWidth=J,l.beginPath(),l.moveTo(D,N),l.lineTo(z,L),l.stroke(),l.beginPath(),l.moveTo(z,L),l.lineTo(z-10*Math.cos(ie-Math.PI/6),L-10*Math.sin(ie-Math.PI/6)),l.lineTo(z-10*Math.cos(ie+Math.PI/6),L-10*Math.sin(ie+Math.PI/6)),l.closePath(),l.fill()};C(A,b,A+I*_*j,b-M*_*j,"#3b82f6",3),C(A,b,A+w.x*j,b-w.y*j,"#f97316",3),l.font="bold 14px system-ui",l.fillStyle="#3b82f6",l.fillText("v",A+I*_*j+10,b-M*_*j-5),l.fillStyle="#f97316",l.fillText("Av",A+w.x*j+10,b-w.y*j-5),l.beginPath(),l.arc(A+I*_*j,b-M*_*j,12,0,2*Math.PI),l.fillStyle=r?"#3b82f6":"#3b82f680",l.fill(),l.strokeStyle="#3b82f6",l.lineWidth=2,l.stroke(),l.font="14px system-ui",u?(l.fillStyle="#22c55e",l.fillText(`✓ Eigenvector found! λ = ${u.eigenvalue}`,10,E-10)):(l.fillStyle="#6b7280",l.fillText("Drag the blue vector to find eigenvectors",10,E-10))},[n,r,u]);const v=h=>{const l=t.current;if(!l)return;const T=l.getBoundingClientRect(),E=h.clientX-T.left-l.width/2,j=-(h.clientY-T.top-l.height/2),A=Math.cos(n)*1.5*80,b=Math.sin(n)*1.5*80;Math.sqrt((E-A)**2+(j-b)**2)<30&&s(!0)},S=g.useCallback(h=>{if(!r)return;const l=t.current;if(!l)return;const T=l.getBoundingClientRect(),E=h.clientX-T.left-l.width/2,j=-(h.clientY-T.top-l.height/2);a(Math.atan2(j,E))},[r]),c=()=>{s(!1)};return e.jsx("canvas",{ref:t,width:500,height:350,className:"border border-border rounded-lg cursor-grab active:cursor-grabbing mx-auto block",onMouseDown:v,onMouseMove:S,onMouseUp:c,onMouseLeave:c})},wo={matrix:"#8b5cf6",eigenvector:"#3b82f6",eigenvalue:"#22c55e"},jo=()=>e.jsx(Ie,{maxWidth:"xl",children:e.jsx(de,{id:"eigenvector-relationship",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(ue,{level:2,children:"The Eigenvector Equation"}),e.jsxs(On,{colorMap:wo,children:[e.jsx(Z,{className:"text-lg leading-relaxed",children:"The defining equation of eigenvalues is beautifully simple:"}),e.jsx("div",{className:"text-center py-6 text-3xl",children:e.jsx(Fn,{latex:"\\clr{matrix}{A}\\clr{eigenvector}{\\vec{v}} = \\clr{eigenvalue}{\\lambda}\\clr{eigenvector}{\\vec{v}}"})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 my-6",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:[e.jsxs("p",{className:"font-semibold mb-1",children:[e.jsx(pe,{name:"matrix",children:"A"})," — The Matrix"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"The transformation we're analyzing"})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:[e.jsxs("p",{className:"font-semibold mb-1",children:[e.jsx(pe,{name:"eigenvector",children:"v"})," — Eigenvector"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"A special vector that doesn't change direction"})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:[e.jsxs("p",{className:"font-semibold mb-1",children:[e.jsx(pe,{name:"eigenvalue",children:"λ"})," — Eigenvalue"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"The stretch factor (how much v scales)"})]})]}),e.jsxs(Z,{className:"leading-relaxed",children:["In words: when we multiply"," ",e.jsx(pe,{name:"matrix",children:"matrix A"})," by an"," ",e.jsx(pe,{name:"eigenvector",children:"eigenvector v"}),", the result is the same as simply multiplying"," ",e.jsx(pe,{name:"eigenvector",children:"v"})," by a number"," ",e.jsx(pe,{name:"eigenvalue",children:"λ"}),". The vector stays on its original line — it just gets longer or shorter!"]})]}),e.jsxs("div",{className:"border-t border-border pt-6 mt-6",children:[e.jsx(ue,{level:3,className:"mb-4",children:"Find the Eigenvectors"}),e.jsxs(Z,{className:"mb-4 text-muted-foreground",children:["Drag the ",e.jsx("span",{style:{color:"#3b82f6"},children:"blue vector (v)"})," around. When v and ",e.jsx("span",{style:{color:"#f97316"},children:"Av (orange)"})," point in the same direction, you've found an eigenvector! The dashed green lines show hints."]}),e.jsx(So,{})]})]})})}),No=()=>{const t=g.useRef(null),[n,a]=g.useState(0),r={a:3,b:1,c:0,d:2},s={a:r.a-n,b:r.b,c:r.c,d:r.d-n},f=s.a*s.d-s.b*s.c,d=Math.abs(f)<.15,x=[2,3].find(m=>Math.abs(n-m)<.15);return g.useEffect(()=>{const m=t.current;if(!m)return;const u=m.getContext("2d");if(!u)return;const v=m.width,S=m.height,c=60,h=v/2,l=S/2;u.fillStyle="#fafafa",u.fillRect(0,0,v,S),u.strokeStyle="#e5e7eb",u.lineWidth=1;for(let M=-5;M<=5;M++)u.beginPath(),u.moveTo(h+M*c,0),u.lineTo(h+M*c,S),u.stroke(),u.beginPath(),u.moveTo(0,l+M*c),u.lineTo(v,l+M*c),u.stroke();u.strokeStyle="#9ca3af",u.lineWidth=2,u.beginPath(),u.moveTo(0,l),u.lineTo(v,l),u.stroke(),u.beginPath(),u.moveTo(h,0),u.lineTo(h,S),u.stroke();const T=(M,_)=>({x:s.a*M+s.b*_,y:s.c*M+s.d*_}),E=[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1}];u.strokeStyle="#3b82f640",u.fillStyle="#3b82f610",u.lineWidth=2,u.beginPath(),u.moveTo(h+E[0].x*c,l-E[0].y*c);for(let M=1;M<E.length;M++)u.lineTo(h+E[M].x*c,l-E[M].y*c);u.closePath(),u.fill(),u.stroke();const j=E.map(M=>T(M.x,M.y));u.strokeStyle=d?"#22c55e":"#f97316",u.fillStyle=d?"#22c55e20":"#f9731620",u.lineWidth=3,u.beginPath(),u.moveTo(h+j[0].x*c,l-j[0].y*c);for(let M=1;M<j.length;M++)u.lineTo(h+j[M].x*c,l-j[M].y*c);u.closePath(),u.fill(),u.stroke();const A=(M,_,w,C,D,N=2)=>{const L=w-M,$=C-_;if(Math.sqrt(L*L+$*$)<3)return;const G=Math.atan2($,L);u.strokeStyle=D,u.fillStyle=D,u.lineWidth=N,u.beginPath(),u.moveTo(M,_),u.lineTo(w,C),u.stroke(),u.beginPath(),u.moveTo(w,C),u.lineTo(w-8*Math.cos(G-Math.PI/6),C-8*Math.sin(G-Math.PI/6)),u.lineTo(w-8*Math.cos(G+Math.PI/6),C-8*Math.sin(G+Math.PI/6)),u.closePath(),u.fill()},b=T(1,0),I=T(0,1);A(h,l,h+b.x*c,l-b.y*c,"#ef4444",3),A(h,l,h+I.x*c,l-I.y*c,"#8b5cf6",3),u.font="13px system-ui",u.fillStyle="#6b7280",u.fillText("(A - λI) transforms the unit square",10,20),d&&x!==void 0?(u.fillStyle="#22c55e",u.font="bold 14px system-ui",u.fillText(`✓ det = 0 at λ = ${x}! This is an eigenvalue!`,10,S-10)):(u.fillStyle="#6b7280",u.fillText(`det(A - λI) = ${f.toFixed(2)}`,10,S-10))},[n,s,f,d,x]),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsx("canvas",{ref:t,width:450,height:350,className:"border border-border rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-4 min-w-[280px]",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:[e.jsxs("label",{className:"text-sm font-medium flex justify-between mb-2",children:[e.jsx("span",{children:"λ (lambda)"}),e.jsx("span",{className:"font-mono text-primary",children:n.toFixed(2)})]}),e.jsx(Mt,{value:[n],onValueChange:([m])=>a(m),min:-1,max:5,step:.05}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Slide to find where det(A - λI) = 0"})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Matrix A:"}),e.jsxs("div",{className:"font-mono text-center",children:["[ 3 , 1 ]",e.jsx("br",{}),"[ 0 , 2 ]"]})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg border border-border",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"A - λI:"}),e.jsxs("div",{className:"font-mono text-center",children:["[ ",s.a.toFixed(1)," , ",s.b.toFixed(1)," ]",e.jsx("br",{}),"[ ",s.c.toFixed(1)," , ",s.d.toFixed(1)," ]"]})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${d?"bg-green-50 border-green-200 dark:bg-green-950/30 dark:border-green-800":"bg-muted/50 border-border"}`,children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Determinant:"}),e.jsx("p",{className:`text-2xl font-mono font-bold ${d?"text-green-600 dark:text-green-400":""}`,children:f.toFixed(3)}),d&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:["Eigenvalue found at λ = ",x,"!"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium mb-1",children:"Hint:"}),e.jsx("p",{children:"Try λ = 2 and λ = 3"})]})]})]})})},Ao={matrix:"#8b5cf6",lambda:"#22c55e",identity:"#f97316"},Mo=()=>e.jsx(Ie,{maxWidth:"xl",children:e.jsx(de,{id:"geometric-eigenvalues",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(ue,{level:2,children:"Finding Eigenvalues: The Geometric View"}),e.jsxs(On,{colorMap:Ao,children:[e.jsxs(Z,{className:"text-lg leading-relaxed",children:["To find eigenvalues, we need to solve a famous equation called the"," ",e.jsx("strong",{children:"characteristic equation"}),":"]}),e.jsx("div",{className:"text-center py-4 text-2xl",children:e.jsx(Fn,{latex:"\\det(\\clr{matrix}{A} - \\clr{lambda}{\\lambda}\\clr{identity}{I}) = 0"})}),e.jsxs(Z,{className:"leading-relaxed",children:["But what does this actually ",e.jsx("em",{children:"mean"})," geometrically? When"," ",e.jsx(pe,{name:"matrix",children:"A"})," minus"," ",e.jsx(pe,{name:"lambda",children:"λ"})," times the"," ",e.jsx(pe,{name:"identity",children:"identity matrix I"})," ","has determinant zero, it means that transformation"," ",e.jsx("strong",{children:"squishes all of space onto a lower dimension"})," — a line or even a point!"]}),e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg border border-border my-4",children:e.jsxs(Z,{children:[e.jsx("strong",{children:"The key insight:"})," When det(A - λI) = 0, the transformation collapses space. The direction it collapses ",e.jsx("em",{children:"onto"})," is exactly the eigenvector direction, and λ is the eigenvalue!"]})})]}),e.jsxs("div",{className:"border-t border-border pt-6",children:[e.jsx(ue,{level:3,className:"mb-4",children:"Interactive: Find the Eigenvalues"}),e.jsx(Z,{className:"mb-4 text-muted-foreground",children:"Adjust λ with the slider. Watch the orange parallelogram — when it collapses to a line, you've found an eigenvalue!"}),e.jsx(No,{})]})]})})}),_o=()=>{const t=g.useRef(null),[n,a]=g.useState("both"),[r,s]=g.useState(0),f=g.useRef(),d=1,i=Math.sqrt(3);return g.useEffect(()=>{const x=()=>{s(m=>m+.03),f.current=requestAnimationFrame(x)};return f.current=requestAnimationFrame(x),()=>{f.current&&cancelAnimationFrame(f.current)}},[]),g.useEffect(()=>{const x=t.current;if(!x)return;const m=x.getContext("2d");if(!m)return;const u=x.width,v=x.height;m.fillStyle="#fafafa",m.fillRect(0,0,u,v);const S=30,c=u-30,h=v/2,l=u*.35,T=u*.65,E=40;let j=0,A=0;n==="mode1"?(j=E*Math.cos(d*r),A=E*Math.cos(d*r)):n==="mode2"?(j=E*Math.cos(i*r),A=-E*Math.cos(i*r)):(j=E/2*Math.cos(d*r)+E/2*Math.cos(i*r),A=E/2*Math.cos(d*r)-E/2*Math.cos(i*r));const b=l+j,I=T+A;m.fillStyle="#374151",m.fillRect(S-10,h-40,10,80),m.fillRect(c,h-40,10,80);const M=(w,C,D,N)=>{const L=(C-w)/12,$=8;m.strokeStyle=N,m.lineWidth=2,m.beginPath(),m.moveTo(w,D);for(let J=0;J<12;J++){const G=w+J*L,se=G+L/2,ee=G+L,ie=J%2===0?$:-$;m.lineTo(se,D+ie),m.lineTo(ee,D)}m.stroke()};M(S,b-20,h,"#6b7280"),M(b+20,I-20,h,"#8b5cf6"),M(I+20,c,h,"#6b7280");const _=40;m.fillStyle="#3b82f6",m.fillRect(b-_/2,h-_/2,_,_),m.fillStyle="#22c55e",m.fillRect(I-_/2,h-_/2,_,_),m.fillStyle="#ffffff",m.font="bold 16px system-ui",m.textAlign="center",m.fillText("m₁",b,h+5),m.fillText("m₂",I,h+5),m.fillStyle="#6b7280",m.font="12px system-ui",m.textAlign="left",n==="mode1"?(m.fillText("Mode 1: In-phase (ω = 1)",10,20),m.fillText("Eigenvalue λ₁ = 1",10,35)):n==="mode2"?(m.fillText("Mode 2: Out-of-phase (ω = √3)",10,20),m.fillText("Eigenvalue λ₂ = 3",10,35)):m.fillText("Both modes superimposed",10,20)},[r,n,d,i]),e.jsxs("div",{className:"space-y-3",children:[e.jsx("canvas",{ref:t,width:340,height:180,className:"border border-border rounded-lg w-full"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>a("mode1"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${n==="mode1"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:"Mode 1 (slow)"}),e.jsx("button",{onClick:()=>a("mode2"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${n==="mode2"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:"Mode 2 (fast)"}),e.jsx("button",{onClick:()=>a("both"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${n==="both"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:"Both"})]})]})},Co=()=>{const t=g.useRef(null),[n,a]=g.useState("stable"),[r,s]=g.useState(0),f=g.useRef();return g.useEffect(()=>{const d=()=>{s(i=>i+.02),f.current=requestAnimationFrame(d)};return f.current=requestAnimationFrame(d),()=>{f.current&&cancelAnimationFrame(f.current)}},[]),g.useEffect(()=>{const d=t.current;if(!d)return;const i=d.getContext("2d");if(!i)return;const x=d.width,m=d.height,u=x/2,v=m/2,S=30;i.fillStyle="#fafafa",i.fillRect(0,0,x,m),i.strokeStyle="#d1d5db",i.lineWidth=1,i.beginPath(),i.moveTo(0,v),i.lineTo(x,v),i.stroke(),i.beginPath(),i.moveTo(u,0),i.lineTo(u,m),i.stroke();let c,h,l,T,E;n==="stable"?(c=-.5,h=-.8,l="#22c55e",T="#22c55e",E="λ₁ < 0, λ₂ < 0 → Stable (decay)"):n==="unstable"?(c=.5,h=.3,l="#ef4444",T="#ef4444",E="λ₁ > 0, λ₂ > 0 → Unstable (growth)"):(c=.5,h=-.5,l="#ef4444",T="#22c55e",E="λ₁ > 0, λ₂ < 0 → Saddle point");const j=8;i.lineWidth=2;for(let A=0;A<j;A++){const b=A/j*2*Math.PI,I=3,M=I*Math.cos(b),_=I*Math.sin(b),w=r%8,C=M*Math.exp(c*w),D=_*Math.exp(h*w);i.strokeStyle=A%2===0?l+"60":T+"60",i.beginPath();for(let N=0;N<=w;N+=.1){const z=M*Math.exp(c*N),L=_*Math.exp(h*N);N===0?i.moveTo(u+z*S,v-L*S):i.lineTo(u+z*S,v-L*S)}i.stroke(),i.beginPath(),i.arc(u+C*S,v-D*S,4,0,2*Math.PI),i.fillStyle=A%2===0?l:T,i.fill()}i.beginPath(),i.arc(u,v,6,0,2*Math.PI),i.fillStyle="#374151",i.fill(),i.fillStyle="#374151",i.font="13px system-ui",i.textAlign="left",i.fillText(E,10,20)},[r,n]),e.jsxs("div",{className:"space-y-3",children:[e.jsx("canvas",{ref:t,width:340,height:180,className:"border border-border rounded-lg w-full"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>a("stable"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${n==="stable"?"bg-green-500 text-white":"bg-muted hover:bg-muted/80"}`,children:"Stable"}),e.jsx("button",{onClick:()=>a("unstable"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${n==="unstable"?"bg-red-500 text-white":"bg-muted hover:bg-muted/80"}`,children:"Unstable"}),e.jsx("button",{onClick:()=>a("saddle"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${n==="saddle"?"bg-amber-500 text-white":"bg-muted hover:bg-muted/80"}`,children:"Saddle"})]})]})},ko=()=>e.jsxs(e.Fragment,{children:[e.jsx(Ie,{maxWidth:"xl",children:e.jsxs(de,{id:"physics-intro",children:[e.jsx(ue,{level:2,children:"Physics Applications"}),e.jsx(Z,{className:"text-lg leading-relaxed mt-2",children:"Eigenvalues aren't just abstract math — they're everywhere in physics! They determine how systems vibrate, whether they're stable, and much more."})]})}),e.jsxs(mn,{columns:2,gap:"lg",children:[e.jsx(de,{id:"physics-oscillators",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{level:3,children:"Coupled Oscillators"}),e.jsxs(Z,{className:"text-sm text-muted-foreground",children:['Two masses connected by springs have special "normal modes" — patterns where everything oscillates at the same frequency. These modes are the ',e.jsx("strong",{children:"eigenvectors"}),", and their frequencies come from the ",e.jsx("strong",{children:"eigenvalues"}),"!"]}),e.jsx(_o,{}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Key insight:"}),e.jsx("p",{className:"text-muted-foreground",children:"Larger eigenvalue → faster oscillation. This is why mode 2 vibrates faster than mode 1!"})]})]})}),e.jsx(de,{id:"physics-stability",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{level:3,children:"Stability Analysis"}),e.jsx(Z,{className:"text-sm text-muted-foreground",children:"Eigenvalues tell us if a system will grow, decay, or stay balanced. This is crucial in engineering, ecology, and economics!"}),e.jsx(Co,{}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"The rule:"}),e.jsxs("ul",{className:"text-muted-foreground space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-green-600",children:"Negative λ"})," → decay (stable)"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-red-600",children:"Positive λ"})," → growth (unstable)"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-amber-600",children:"Mixed signs"})," → saddle point"]})]})]})]})})]})]}),Do=({icon:t,title:n,description:a,color:r})=>e.jsxs("div",{className:"p-5 rounded-xl border border-border bg-card hover:shadow-md transition-shadow",style:{borderLeftWidth:"4px",borderLeftColor:r},children:[e.jsx("div",{className:"text-3xl mb-3",children:t}),e.jsx("h4",{className:"font-semibold text-lg mb-2",children:n}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a})]}),Ro=()=>{const t=[{icon:"🎯",title:"Eigenvectors Stay on Their Line",description:"When a matrix transforms an eigenvector, it only stretches or shrinks — it never rotates off its original direction.",color:"#3b82f6"},{icon:"📏",title:"Eigenvalues Are Stretch Factors",description:"The eigenvalue λ tells you exactly how much an eigenvector gets scaled: λ > 1 stretches, 0 < λ < 1 shrinks, λ < 0 flips.",color:"#22c55e"},{icon:"🔢",title:"The Defining Equation",description:"Av = λv — this simple equation captures the entire relationship between a matrix, its eigenvectors, and eigenvalues.",color:"#8b5cf6"},{icon:"🔍",title:"det(A - λI) = 0 Finds Eigenvalues",description:"When this determinant equals zero, the transformation squishes space — and λ at that moment is an eigenvalue.",color:"#f97316"},{icon:"🎵",title:"Physics: Natural Frequencies",description:"In vibrating systems, eigenvalues determine the natural frequencies — how fast things oscillate in their normal modes.",color:"#ec4899"},{icon:"⚖️",title:"Physics: Stability",description:"Negative eigenvalues mean stability (decay), positive mean instability (growth). This predicts system behavior!",color:"#14b8a6"}];return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{maxWidth:"xl",children:e.jsx(de,{id:"summary-header",children:e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(ue,{level:2,children:"Key Takeaways"}),e.jsx(Z,{className:"text-lg text-muted-foreground mt-2 max-w-2xl mx-auto",children:"You've explored the intuition behind eigenvalues. Here's what to remember:"})]})})}),e.jsx(mn,{columns:3,gap:"md",children:t.map((n,a)=>e.jsx(de,{id:`summary-card-${a}`,padding:"none",children:e.jsx(Do,{...n})},a))}),e.jsx(Ie,{maxWidth:"xl",children:e.jsxs(de,{id:"summary-final",children:[e.jsx("div",{className:"mt-8 p-6 bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl border border-border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"The Big Picture"}),e.jsx("div",{className:"text-2xl mb-4",children:e.jsx(In,{latex:"A\\vec{v} = \\lambda\\vec{v}"})}),e.jsxs(Z,{className:"max-w-2xl mx-auto",children:["Eigenvalues and eigenvectors reveal the ",e.jsx("strong",{children:"essential character"}),' of a transformation. They tell us which directions are "special" (eigenvectors) and how much those directions get scaled (eigenvalues). This insight is foundational across mathematics, physics, engineering, and data science.']})]})}),e.jsxs("div",{className:"mt-8 p-5 bg-muted/50 rounded-lg border border-border",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"You should now be able to:"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"✓"}),e.jsx("span",{children:"Explain what an eigenvector is geometrically"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"✓"}),e.jsx("span",{children:'Understand eigenvalues as "stretch factors"'})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"✓"}),e.jsx("span",{children:"Visualize how det(A - λI) = 0 relates to finding eigenvalues"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"✓"}),e.jsx("span",{children:"Connect eigenvalues to real physics applications"})]})]})]})]})})]})};Ys.getState().initialize(Zs());const Lo=[e.jsx(Ie,{maxWidth:"xl",children:e.jsxs(de,{id:"lesson-header",padding:"lg",children:[e.jsx("div",{className:"text-center mb-2",children:e.jsx("span",{className:"text-sm font-medium text-primary uppercase tracking-wider",children:"Linear Algebra"})}),e.jsx(ue,{level:1,className:"text-center text-4xl md:text-5xl font-bold mb-4",children:"Understanding Eigenvalues"}),e.jsx("p",{className:"text-center text-muted-foreground text-lg max-w-2xl mx-auto",children:"Discover the special vectors that reveal how transformations really work"})]})},"lesson-header"),e.jsxs(un,{ratio:"1:1",gap:"lg",children:[e.jsx(de,{id:"intro-content",children:e.jsx(Qs,{})}),e.jsx(de,{id:"intro-viz",children:e.jsx(eo,{})})]},"section-1-intro"),e.jsx(Eo,{},"section-2-transform"),e.jsx(jo,{},"section-3-relationship"),e.jsx(Mo,{},"section-4-geometric"),e.jsx(ko,{},"section-5-physics"),e.jsx(Ro,{},"section-6-summary")];export{Lo as sections};
